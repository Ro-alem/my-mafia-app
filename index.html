<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Game App</title>
    <style>
        /* Весь твой дизайн остается тут */
        :root { --mafia: #ff3b30; --mafia2: #ffcc00; --among: #34c759; }
        body { font-family: -apple-system, sans-serif; background: #000; color: #fff; margin: 0; padding: 50px 20px; transition: 0.5s; }
        body.mafia { background: #1a0505; --accent: var(--mafia); }
        body.mafia2 { background: #05101a; --accent: var(--mafia2); }
        body.among { background: #051a0a; --accent: var(--among); }
        .tabs { display: flex; gap: 8px; background: rgba(255,255,255,0.1); padding: 5px; border-radius: 12px; margin-bottom: 25px; }
        .tabs button { flex: 1; padding: 12px; border: none; border-radius: 9px; background: none; color: #888; font-weight: 600; }
        .tabs button.active { background: rgba(255,255,255,0.2); color: #fff; }
        .item { background: rgba(255,255,255,0.06); padding: 15px; border-radius: 14px; display: flex; align-items: center; gap: 12px; margin-top: 10px; }
        .add-btn { width: 44px; height: 44px; border-radius: 50%; border: none; background: var(--accent); color: #fff; font-size: 28px; }
    </style>
</head>
<body class="mafia">
    <div class="tabs">
        <button onclick="setTab('mafia')" id="b-mafia" class="active">Mafia</button>
        <button onclick="setTab('mafia2')" id="b-mafia2">Mafia 2.0</button>
        <button onclick="setTab('among')" id="b-among">Among</button>
    </div>
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h1 id="title">Mafia</h1>
        <button class="add-btn" onclick="add()">+</button>
    </div>
    <div id="list"></div>

    <script>
        // ЛОГИКА СОХРАНЕНИЯ
        let cur = 'mafia';
        let data = JSON.parse(localStorage.getItem('games_db')) || { mafia:[], mafia2:[], among:[] };

        function setTab(t) {
            cur = t;
            document.body.className = t;
            document.querySelectorAll('.tabs button').forEach(b => b.classList.remove('active'));
            document.getElementById('b-'+t).classList.add('active');
            render();
        }

        function add() {
            let t = prompt("Время:");
            if(t) { data[cur].push({id:Date.now(), t:t, d:false}); save(); }
        }

        function save() {
            localStorage.setItem('games_db', JSON.stringify(data));
            render();
        }

        function render() {
            const container = document.getElementById('list');
            container.innerHTML = '';
            data[cur].forEach(i => {
                container.innerHTML += `<div class="item">
                    <input type="checkbox" ${i.d?'checked':''} onclick="data['${cur}'].find(x=>x.id==${i.id}).d = !data['${cur}'].find(x=>x.id==${i.id}).d; save();">
                    <span style="${i.d?'text-decoration:line-through;opacity:0.5':''}">${i.t}</span>
                    <button style="background:none; border:none; color:red;" onclick="data['${cur}']=data['${cur}'].filter(x=>x.id!=${i.id}); save();">✕</button>
                </div>`;
            });
        }
        render();

        // МАГИЯ ОФФЛАЙНА (Service Worker)
        if ('serviceWorker' in navigator) {
            const swCode = `
                self.addEventListener('install', e => {
                    e.waitUntil(caches.open('pwa-cache').then(cache => cache.addAll(['./', 'index.html'])));
                });
                self.addEventListener('fetch', e => {
                    e.respondWith(caches.match(e.request).then(res => res || fetch(e.request)));
                });
            `;
            const blob = new Blob([swCode], {type: 'application/javascript'});
            navigator.serviceWorker.register(URL.createObjectURL(blob));
        }
    </script>
</body>
</html>
